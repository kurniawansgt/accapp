/*
 * GeneratTable.java
 *
 * Created on February 18, 2009, 8:23 AM
 */

package generate.component;

import common.jdbc.DbBean;
import common.jdbc.DbBeanCommon;
import generate.objectclasses.GenerateForm;
import generate.objectclasses.GenerateObject;
import java.sql.SQLException;
import java.util.Date;
import javax.swing.DefaultListModel;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import common.utils.CodeException;
import common.utils.GlobalUtils;

/**
 *
 * @author  root
 */
public class FrmGenerate extends javax.swing.JFrame {

    /** Creates new form GeneratTable */
    public FrmGenerate() {
        initComponents();
        
        jtxtLocationSrc.setText(GlobalUtils.getCurrentDir() + "/src/test/");
        jtxtLocationForm.setText(GlobalUtils.getCurrentDir() + "/src/test/");
        
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jlistTablesGenerate = new javax.swing.JList();
        jbtnDeselectAll = new javax.swing.JButton();
        jbtnSelectAll = new javax.swing.JButton();
        jbtnSelectOne = new javax.swing.JButton();
        jbtnDeselectOne = new javax.swing.JButton();
        jScrollPane2 = new javax.swing.JScrollPane();
        jlistTables = new javax.swing.JList();
        jLabel2 = new javax.swing.JLabel();
        jtxtDriver = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jtxtUrl = new javax.swing.JTextField();
        jbtnLoadTables = new javax.swing.JButton();
        jSeparator1 = new javax.swing.JSeparator();
        jLabel4 = new javax.swing.JLabel();
        jtxtPackageForm = new javax.swing.JTextField();
        jbtnGenerate = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        jtextAreaReport = new javax.swing.JTextArea();
        jLabel5 = new javax.swing.JLabel();
        jtxtLocationSrc = new javax.swing.JTextField();
        jtxtLocationForm = new javax.swing.JTextField();
        jchkForm = new javax.swing.JCheckBox();
        jSeparator2 = new javax.swing.JSeparator();
        jLabel6 = new javax.swing.JLabel();
        jtxtPackageClass = new javax.swing.JTextField();
        jbtnBrowseDirSource = new javax.swing.JToggleButton();
        jbtnBrowseDirForm = new javax.swing.JToggleButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Generate From Table");
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowOpened(java.awt.event.WindowEvent evt) {
                formWindowOpened(evt);
            }
        });
        getContentPane().setLayout(null);

        jLabel1.setFont(new java.awt.Font("Dialog", 1, 24));
        jLabel1.setText("Generate From Table ");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(30, 0, 380, 30);

        jScrollPane1.setViewportView(jlistTablesGenerate);

        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(270, 260, 140, 270);

        jbtnDeselectAll.setText("<<");
        jbtnDeselectAll.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtnDeselectAllActionPerformed(evt);
            }
        });
        getContentPane().add(jbtnDeselectAll);
        jbtnDeselectAll.setBounds(180, 420, 70, 30);

        jbtnSelectAll.setText(">>");
        jbtnSelectAll.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtnSelectAllActionPerformed(evt);
            }
        });
        getContentPane().add(jbtnSelectAll);
        jbtnSelectAll.setBounds(180, 300, 70, 30);

        jbtnSelectOne.setText(">");
        jbtnSelectOne.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtnSelectOneActionPerformed(evt);
            }
        });
        getContentPane().add(jbtnSelectOne);
        jbtnSelectOne.setBounds(180, 340, 70, 30);

        jbtnDeselectOne.setText("<");
        jbtnDeselectOne.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtnDeselectOneActionPerformed(evt);
            }
        });
        getContentPane().add(jbtnDeselectOne);
        jbtnDeselectOne.setBounds(180, 380, 70, 30);

        jlistTables.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jScrollPane2.setViewportView(jlistTables);

        getContentPane().add(jScrollPane2);
        jScrollPane2.setBounds(30, 260, 140, 270);

        jLabel2.setText("Driver");
        getContentPane().add(jLabel2);
        jLabel2.setBounds(30, 160, 90, 18);

        jtxtDriver.setEditable(false);
        getContentPane().add(jtxtDriver);
        jtxtDriver.setBounds(90, 160, 320, 28);

        jLabel3.setText("Url");
        getContentPane().add(jLabel3);
        jLabel3.setBounds(30, 180, 60, 18);
        getContentPane().add(jtxtUrl);
        jtxtUrl.setBounds(90, 180, 320, 28);

        jbtnLoadTables.setText("LoadTables");
        jbtnLoadTables.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtnLoadTablesActionPerformed(evt);
            }
        });
        getContentPane().add(jbtnLoadTables);
        jbtnLoadTables.setBounds(30, 220, 140, 30);

        jSeparator1.setOrientation(javax.swing.SwingConstants.VERTICAL);
        getContentPane().add(jSeparator1);
        jSeparator1.setBounds(430, 160, 10, 370);

        jLabel4.setText("Package Form");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(30, 110, 100, 20);

        jtxtPackageForm.setText("test");
        getContentPane().add(jtxtPackageForm);
        jtxtPackageForm.setBounds(140, 110, 790, 28);

        jbtnGenerate.setText("Generate");
        jbtnGenerate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtnGenerateActionPerformed(evt);
            }
        });
        getContentPane().add(jbtnGenerate);
        jbtnGenerate.setBounds(440, 160, 580, 30);

        jScrollPane3.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);

        jtextAreaReport.setColumns(20);
        jtextAreaReport.setLineWrap(true);
        jtextAreaReport.setRows(5);
        jtextAreaReport.setWrapStyleWord(true);
        jScrollPane3.setViewportView(jtextAreaReport);

        getContentPane().add(jScrollPane3);
        jScrollPane3.setBounds(440, 190, 580, 340);

        jLabel5.setText("Dir Source");
        getContentPane().add(jLabel5);
        jLabel5.setBounds(30, 60, 90, 18);

        jtxtLocationSrc.setText("/home/wgata/NetBeansProjects/Manufaktur/src/test");
        getContentPane().add(jtxtLocationSrc);
        jtxtLocationSrc.setBounds(140, 60, 790, 28);

        jtxtLocationForm.setText("/home/wgata/NetBeansProjects/Manufaktur/src/test");
        jtxtLocationForm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtxtLocationFormActionPerformed(evt);
            }
        });
        getContentPane().add(jtxtLocationForm);
        jtxtLocationForm.setBounds(140, 130, 790, 28);

        jchkForm.setSelected(true);
        jchkForm.setText("Dir Form");
        getContentPane().add(jchkForm);
        jchkForm.setBounds(30, 130, 90, 24);
        getContentPane().add(jSeparator2);
        jSeparator2.setBounds(0, 90, 930, 10);

        jLabel6.setText("Package Class");
        getContentPane().add(jLabel6);
        jLabel6.setBounds(30, 40, 100, 18);

        jtxtPackageClass.setText("test");
        getContentPane().add(jtxtPackageClass);
        jtxtPackageClass.setBounds(140, 40, 790, 28);

        jbtnBrowseDirSource.setText("...");
        jbtnBrowseDirSource.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtnBrowseDirSourceActionPerformed(evt);
            }
        });
        getContentPane().add(jbtnBrowseDirSource);
        jbtnBrowseDirSource.setBounds(930, 60, 30, 17);

        jbtnBrowseDirForm.setText("...");
        jbtnBrowseDirForm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtnBrowseDirFormActionPerformed(evt);
            }
        });
        getContentPane().add(jbtnBrowseDirForm);
        jbtnBrowseDirForm.setBounds(930, 130, 30, 17);

        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width-1051)/2, (screenSize.height-581)/2, 1051, 581);
    }// </editor-fold>//GEN-END:initComponents

private void formWindowOpened(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowOpened

        this.jtxtDriver.setText(DbBeanCommon.getDriver());
        this.jtxtUrl.setText(DbBean.getUrl());

   
    
}//GEN-LAST:event_formWindowOpened

private void jbtnLoadTablesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtnLoadTablesActionPerformed
    try {
      
        listModelTables = new DefaultListModel();
        String[] tables = GenerateObject.getAllTables();
      
        for (int i=0; i < tables.length  ; i++) {
            listModelTables.addElement(tables[i]);
        }

        this.jlistTables.setModel(listModelTables);
        
        
        this.listModelTablesGenerate.removeAllElements();
        this.jlistTablesGenerate.setModel(this.listModelTablesGenerate);
        
    } catch (CodeException ex) {
        ex.printStackTrace();
    } catch (SQLException ex) {
        ex.printStackTrace();
    }   
}//GEN-LAST:event_jbtnLoadTablesActionPerformed

private void jbtnSelectAllActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtnSelectAllActionPerformed

    
    if ( listModelTables.getSize() > 0 ) {
        for (int i = 0 ; i < listModelTables.getSize() ; i++) {
            listModelTablesGenerate.addElement(listModelTables.getElementAt(i));
        }
                        
        listModelTables.removeAllElements();
        
        this.jlistTablesGenerate.setModel(listModelTablesGenerate);
                
    }else{
        JOptionPane.showMessageDialog(null, "Table is Not Exist");
    }
}//GEN-LAST:event_jbtnSelectAllActionPerformed

private void jbtnSelectOneActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtnSelectOneActionPerformed

    int i = jlistTables.getSelectedIndex() ;

    if (i >= 0) {
        this.listModelTablesGenerate.addElement(this.listModelTables.getElementAt(i));
        this.jlistTablesGenerate.setModel(listModelTablesGenerate);
    
        this.listModelTables.removeElementAt(i);
        this.jlistTables.setModel(listModelTables);
    }
    
}//GEN-LAST:event_jbtnSelectOneActionPerformed

private void jbtnDeselectAllActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtnDeselectAllActionPerformed
    if ( listModelTablesGenerate.getSize() > 0 ) {
        for (int i = 0 ; i < listModelTablesGenerate.getSize() ; i++) {
            listModelTables.addElement(listModelTablesGenerate.getElementAt(i));
        }
                        
        listModelTablesGenerate.removeAllElements();
        
        this.jlistTables.setModel(listModelTables);
                
    }else{
        JOptionPane.showMessageDialog(null, "Table is Not Exist");
    }
}//GEN-LAST:event_jbtnDeselectAllActionPerformed

private void jbtnDeselectOneActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtnDeselectOneActionPerformed

   int i = jlistTablesGenerate.getSelectedIndex() ;

    if (i >= 0) {
        this.listModelTables.addElement(this.listModelTablesGenerate.getElementAt(i));
        this.jlistTables.setModel(listModelTables);
    
        this.listModelTablesGenerate.removeElementAt(i);
        this.jlistTablesGenerate.setModel(listModelTablesGenerate);
    }
        
}//GEN-LAST:event_jbtnDeselectOneActionPerformed

private void jbtnGenerateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtnGenerateActionPerformed
    GenerateObject generateobject ;
    GenerateForm generateform;
    
    this.jtextAreaReport.setText("");
    for(int i = 0; i<listModelTablesGenerate.getSize(); i++){
        
        Date date = new Date();
        
        generateobject = new GenerateObject((String) listModelTablesGenerate.getElementAt(i), 
                                this.jtxtPackageClass.getText(), 
                                this.jtxtLocationSrc.getText() );
        
        this.jtextAreaReport.setText(this.jtextAreaReport.getText() + "\n [" + date + "] " + generateobject.getSaveToFile());
        

        if (this.jchkForm.isSelected()) {

            generateform = new GenerateForm((String) listModelTablesGenerate.getElementAt(i),
                                    this.jtxtPackageForm.getText(),
                                    this.jtxtLocationForm.getText(),
                                    this.jtxtPackageClass.getText()
                                    );

            this.jtextAreaReport.setText(this.jtextAreaReport.getText() + "\n [" + date + "] " + generateform.getSaveToFile());
        }
    }
    
    
}//GEN-LAST:event_jbtnGenerateActionPerformed

private void jbtnBrowseDirSourceActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtnBrowseDirSourceActionPerformed
    JFileChooser chooser = new JFileChooser(".");
    chooser.setDialogTitle("Pilih Directory ");
    chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);

    
    if (chooser.showOpenDialog(null) == JFileChooser.APPROVE_OPTION) { 
        
        jtxtLocationSrc.setText(chooser.getSelectedFile().getPath());
    }else {
      JOptionPane.showMessageDialog(null,"No Selection ");
    }
    

}//GEN-LAST:event_jbtnBrowseDirSourceActionPerformed

private void jtxtLocationFormActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtxtLocationFormActionPerformed

}//GEN-LAST:event_jtxtLocationFormActionPerformed

private void jbtnBrowseDirFormActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtnBrowseDirFormActionPerformed
    JFileChooser chooser = new JFileChooser(".");
    chooser.setDialogTitle("Pilih Directory ");
    chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);

    
    if (chooser.showOpenDialog(null) == JFileChooser.APPROVE_OPTION) { 
        jtxtLocationForm.setText(chooser.getSelectedFile().getPath());
    }else {
      JOptionPane.showMessageDialog(null,"No Selection ");
    }


}//GEN-LAST:event_jbtnBrowseDirFormActionPerformed

    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new FrmGenerate().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JToggleButton jbtnBrowseDirForm;
    private javax.swing.JToggleButton jbtnBrowseDirSource;
    private javax.swing.JButton jbtnDeselectAll;
    private javax.swing.JButton jbtnDeselectOne;
    private javax.swing.JButton jbtnGenerate;
    private javax.swing.JButton jbtnLoadTables;
    private javax.swing.JButton jbtnSelectAll;
    private javax.swing.JButton jbtnSelectOne;
    private javax.swing.JCheckBox jchkForm;
    private javax.swing.JList jlistTables;
    private javax.swing.JList jlistTablesGenerate;
    private javax.swing.JTextArea jtextAreaReport;
    private javax.swing.JTextField jtxtDriver;
    private javax.swing.JTextField jtxtLocationForm;
    private javax.swing.JTextField jtxtLocationSrc;
    private javax.swing.JTextField jtxtPackageClass;
    private javax.swing.JTextField jtxtPackageForm;
    private javax.swing.JTextField jtxtUrl;
    // End of variables declaration//GEN-END:variables

    private DefaultListModel listModelTables = new DefaultListModel();
    private DefaultListModel listModelTablesGenerate = new DefaultListModel();
    

    
}
